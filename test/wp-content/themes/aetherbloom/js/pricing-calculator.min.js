const pricingData={selectedRole:"Customer Service Representative",selectedTier:"enterprise",isVisible:!1,isRoleDropdownOpen:!1,isTierDropdownOpen:!1,isMultiAgent:!1,agentCount:1},pricingElements={};function initPricingCalculator(){cacheElements(),pricingElements.section&&initIntersectionObserver(),initDropdowns(),initClickOutsideHandling(),window.calculatorData&&window.calculatorData.defaults&&(pricingData.selectedRole=window.calculatorData.defaults.role,pricingData.selectedTier=window.calculatorData.defaults.tier,updateMultiAgentState()),updateCalculations()}function cacheElements(){pricingElements.section=document.querySelector(".calculator-section"),pricingElements.wrapper=document.getElementById("calculator-wrapper"),pricingElements.roleDropdown=document.getElementById("role-dropdown"),pricingElements.roleDropdownTrigger=document.getElementById("role-dropdown-trigger"),pricingElements.roleDropdownMenu=document.getElementById("role-dropdown-menu"),pricingElements.roleLabel=document.getElementById("role-label"),pricingElements.roleArrow=document.getElementById("role-arrow"),pricingElements.roleOptions=Array.from(document.querySelectorAll("#role-dropdown-menu .dropdown-option")),pricingElements.tierDropdown=document.getElementById("tier-dropdown"),pricingElements.tierDropdownTrigger=document.getElementById("tier-dropdown-trigger"),pricingElements.tierDropdownMenu=document.getElementById("tier-dropdown-menu"),pricingElements.tierLabel=document.getElementById("tier-label"),pricingElements.tierArrow=document.getElementById("tier-arrow"),pricingElements.tierOptions=Array.from(document.querySelectorAll("#tier-dropdown-menu .dropdown-option")),pricingElements.ukBaseSalary=document.getElementById("uk-base-salary"),pricingElements.ukEmployerNi=document.getElementById("uk-employer-ni"),pricingElements.ukPension=document.getElementById("uk-pension"),pricingElements.ukHoliday=document.getElementById("uk-holiday"),pricingElements.ukTraining=document.getElementById("uk-training"),pricingElements.ukOffice=document.getElementById("uk-office"),pricingElements.ukEquipment=document.getElementById("uk-equipment"),pricingElements.ukInsurance=document.getElementById("uk-insurance"),pricingElements.ukTotalCost=document.getElementById("uk-total-cost"),pricingElements.ukSalaryLabel=document.getElementById("uk-salary-label"),pricingElements.ukNiLabel=document.getElementById("uk-ni-label"),pricingElements.ukPensionLabel=document.getElementById("uk-pension-label"),pricingElements.ukHolidayLabel=document.getElementById("uk-holiday-label"),pricingElements.ukTrainingLabel=document.getElementById("uk-training-label"),pricingElements.ukOfficeLabel=document.getElementById("uk-office-label"),pricingElements.ukEquipmentLabel=document.getElementById("uk-equipment-label"),pricingElements.ukInsuranceLabel=document.getElementById("uk-insurance-label"),pricingElements.ukTotalLabel=document.getElementById("uk-total-label"),pricingElements.aetherbloomServiceFee=document.getElementById("aetherbloom-service-fee"),pricingElements.aetherbloomTotalCost=document.getElementById("aetherbloom-total-cost"),pricingElements.savingsAmount=document.getElementById("savings-amount"),pricingElements.savingsPercentage=document.getElementById("savings-percentage")}function initIntersectionObserver(){new IntersectionObserver(e=>{e.forEach(e=>{pricingData.isVisible=e.isIntersecting,updateSectionVisibility()})},{threshold:.1,rootMargin:"-50px 0px -50px 0px"}).observe(pricingElements.section)}function updateSectionVisibility(){pricingElements.wrapper&&(pricingData.isVisible?pricingElements.wrapper.classList.add("visible"):pricingElements.wrapper.classList.remove("visible"))}function initDropdowns(){pricingElements.roleDropdownTrigger&&pricingElements.roleDropdownTrigger.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),toggleRoleDropdown()}),pricingElements.roleOptions.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation();selectRole(e.currentTarget.dataset.role),closeRoleDropdown()})}),pricingElements.tierDropdownTrigger&&pricingElements.tierDropdownTrigger.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),toggleTierDropdown()}),pricingElements.tierOptions.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation();selectTier(e.currentTarget.dataset.tier),closeTierDropdown()})})}function initClickOutsideHandling(){document.addEventListener("click",e=>{pricingElements.roleDropdown&&!pricingElements.roleDropdown.contains(e.target)&&closeRoleDropdown(),pricingElements.tierDropdown&&!pricingElements.tierDropdown.contains(e.target)&&closeTierDropdown()})}function toggleRoleDropdown(){pricingData.isRoleDropdownOpen?closeRoleDropdown():(closeTierDropdown(),openRoleDropdown())}function openRoleDropdown(){pricingData.isRoleDropdownOpen=!0,pricingElements.roleDropdownMenu&&(pricingElements.roleDropdownMenu.style.display="block",pricingElements.roleDropdownMenu.offsetHeight),pricingElements.roleArrow&&pricingElements.roleArrow.classList.add("open"),pricingElements.roleDropdownTrigger&&pricingElements.roleDropdownTrigger.setAttribute("aria-expanded","true")}function closeRoleDropdown(){pricingData.isRoleDropdownOpen=!1,pricingElements.roleDropdownMenu&&(pricingElements.roleDropdownMenu.style.display="none"),pricingElements.roleArrow&&pricingElements.roleArrow.classList.remove("open"),pricingElements.roleDropdownTrigger&&pricingElements.roleDropdownTrigger.setAttribute("aria-expanded","false")}function toggleTierDropdown(){pricingData.isTierDropdownOpen?closeTierDropdown():(closeRoleDropdown(),openTierDropdown())}function openTierDropdown(){pricingData.isTierDropdownOpen=!0,pricingElements.tierDropdownMenu&&(pricingElements.tierDropdownMenu.style.display="block",pricingElements.tierDropdownMenu.offsetHeight),pricingElements.tierArrow&&pricingElements.tierArrow.classList.add("open"),pricingElements.tierDropdownTrigger&&pricingElements.tierDropdownTrigger.setAttribute("aria-expanded","true")}function closeTierDropdown(){pricingData.isTierDropdownOpen=!1,pricingElements.tierDropdownMenu&&(pricingElements.tierDropdownMenu.style.display="none"),pricingElements.tierArrow&&pricingElements.tierArrow.classList.remove("open"),pricingElements.tierDropdownTrigger&&pricingElements.tierDropdownTrigger.setAttribute("aria-expanded","false")}function selectRole(e){e&&(pricingData.selectedRole=e,pricingElements.roleLabel&&(pricingElements.roleLabel.textContent=e),pricingElements.roleOptions.forEach(n=>{n.dataset.role===e?n.classList.add("selected"):n.classList.remove("selected")}),updateCalculations())}function selectTier(e){if(!e)return;pricingData.selectedTier=e,updateMultiAgentState();const n=getTierData(e);n&&pricingElements.tierLabel&&(pricingElements.tierLabel.textContent=n.name),pricingElements.tierOptions.forEach(n=>{n.dataset.tier===e?n.classList.add("selected"):n.classList.remove("selected")}),updateCalculations()}function updateMultiAgentState(){const e=getTierData(pricingData.selectedTier);e&&(pricingData.isMultiAgent=e.is_multi_agent||!1,pricingData.agentCount=e.agent_count||1,updateUKLabels())}function updateUKLabels(){const e=pricingData.isMultiAgent?`${pricingData.agentCount}x `:"",n=pricingData.isMultiAgent?` (${pricingData.agentCount} positions)`:"";pricingElements.ukSalaryLabel&&(pricingElements.ukSalaryLabel.textContent=`${e}Base salary`),pricingElements.ukNiLabel&&(pricingElements.ukNiLabel.textContent=`${e}Employer NI`),pricingElements.ukPensionLabel&&(pricingElements.ukPensionLabel.textContent=`${e}Pension`),pricingElements.ukHolidayLabel&&(pricingElements.ukHolidayLabel.textContent=`${e}Holiday pay`),pricingElements.ukTrainingLabel&&(pricingElements.ukTrainingLabel.textContent=`${e}Training`),pricingElements.ukOfficeLabel&&(pricingElements.ukOfficeLabel.textContent=`${e}Office space`),pricingElements.ukEquipmentLabel&&(pricingElements.ukEquipmentLabel.textContent=`${e}Equipment`),pricingElements.ukInsuranceLabel&&(pricingElements.ukInsuranceLabel.textContent=`${e}Insurance`),pricingElements.ukTotalLabel&&(pricingElements.ukTotalLabel.textContent=`Total annual cost${n}`)}function getRoleData(e){return window.calculatorData&&window.calculatorData.roles?window.calculatorData.roles.find(n=>n.name===e):null}function getTierData(e){return window.calculatorData&&window.calculatorData.tiers?window.calculatorData.tiers.find(n=>n.id===e):null}function calculateUKCosts(e,n=1){const t=e*n,i=Math.round(.138*t*n),r=Math.round(.03*t*n),o=Math.round(.077*t*n),l=1500*n,a=4800*n,c=800*n,s=534*n;return{baseSalary:t,employerNI:i,pension:r,holidayPay:o,training:l,officeSpace:a,equipment:c,insurance:s,total:t+i+r+o+l+a+c+s}}function updateCalculations(){const e=getRoleData(pricingData.selectedRole),n=getTierData(pricingData.selectedTier);if(!e||!n)return void console.warn("Missing role or tier data");const t=pricingData.isMultiAgent?pricingData.agentCount:1,i=calculateUKCosts(e.salary,t),r=n.cost;updateElement(pricingElements.ukBaseSalary,formatCurrency(i.baseSalary)),updateElement(pricingElements.ukEmployerNi,formatCurrency(i.employerNI)),updateElement(pricingElements.ukPension,formatCurrency(i.pension)),updateElement(pricingElements.ukHoliday,formatCurrency(i.holidayPay)),updateElement(pricingElements.ukTraining,formatCurrency(i.training)),updateElement(pricingElements.ukOffice,formatCurrency(i.officeSpace)),updateElement(pricingElements.ukEquipment,formatCurrency(i.equipment)),updateElement(pricingElements.ukInsurance,formatCurrency(i.insurance)),updateElement(pricingElements.ukTotalCost,formatCurrency(i.total)),updateElement(pricingElements.aetherbloomServiceFee,formatCurrency(r)),updateElement(pricingElements.aetherbloomTotalCost,formatCurrency(r));const o=i.total-r,l=Math.round(o/i.total*100);updateElement(pricingElements.savingsAmount,formatCurrency(o)),updateElement(pricingElements.savingsPercentage,`${l}%`)}function updateElement(e,n){e&&(e.textContent=n)}function formatCurrency(e){return`Â£${e.toLocaleString()}`}document.addEventListener("DOMContentLoaded",function(){document.querySelector(".calculator-section")&&initPricingCalculator()});