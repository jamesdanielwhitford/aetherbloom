!function(){"use strict";const e="145903429",t="d38ffeaa-6505-4879-ac11-27619fdbb1d0",n="https://meetings-eu1.hubspot.com/aetherbloom",r="https://api.hsforms.com/submissions/v3/integration/submit";let o={isVisible:!1,isHovering:!1,mousePosition:{x:0,y:0,rotateX:0,rotateY:0},isCtaServiceDropdownOpen:!1,formData:{company:"",firstname:"",lastname:"",email:"",phone:"",primary_service:"",addon_services:[],consent_processing:!1},isSubmitting:!1,ajaxUrl:"",restUrl:"",nonce:"",restNonce:"",currentStep:1,totalSteps:3},s={section:null,wrapper:null,form:null,steps:[],stepIndicators:[],stepConnectors:[],formInputs:{company:null,firstname:null,lastname:null,email:null,phone:null,primary_service:null,addon_services:[],consent_processing:null},ctaServiceDropdown:null,ctaServiceDropdownTrigger:null,ctaServiceDropdownMenu:null,ctaServiceLabel:null,ctaServiceArrow:null,ctaServiceOptions:[],navigationButtons:{previous:null,next:null,submit:null},formMessages:null,formSuccess:null,formError:null,formLoading:null};function i(){void 0!==window.aetherbloomCTAData?(o.ajaxUrl=window.aetherbloomCTAData.ajaxUrl,o.restUrl=window.aetherbloomCTAData.restUrl||"",o.nonce=window.aetherbloomCTAData.nonce,o.restNonce=window.aetherbloomCTAData.restNonce||""):(console.warn("aetherbloomCTAData not found. Using HubSpot direct submission."),"undefined"!=typeof ajaxurl&&(o.ajaxUrl=ajaxurl)),s.section=document.querySelector(".cta-section"),s.wrapper=document.getElementById("cta-wrapper"),s.form=document.getElementById("contact-form"),s.steps=document.querySelectorAll(".form-step"),s.stepIndicators=document.querySelectorAll(".step-indicator"),s.stepConnectors=document.querySelectorAll(".step-connector"),s.formInputs.company=document.getElementById("company-name"),s.formInputs.firstname=document.getElementById("first-name"),s.formInputs.lastname=document.getElementById("last-name"),s.formInputs.email=document.getElementById("contact-email"),s.formInputs.phone=document.getElementById("phone-number"),s.ctaServiceDropdown=document.getElementById("cta-service-dropdown"),s.ctaServiceDropdownTrigger=document.getElementById("cta-service-dropdown-trigger"),s.ctaServiceDropdownMenu=document.getElementById("cta-service-dropdown-menu"),s.ctaServiceLabel=document.getElementById("cta-service-label"),s.ctaServiceArrow=document.getElementById("cta-service-arrow"),s.ctaServiceOptions=Array.from(document.querySelectorAll("#cta-service-dropdown-menu .dropdown-option")),s.formInputs.primary_service=document.getElementById("primary-service"),s.formInputs.addon_services=document.querySelectorAll('input[name="addon_services"]'),s.formInputs.consent_processing=document.getElementById("consent-processing"),s.navigationButtons.submit=document.getElementById("contact-submit"),s.formMessages=document.getElementById("form-messages"),s.formSuccess=document.getElementById("form-success"),s.formError=document.getElementById("form-error"),s.formLoading=document.getElementById("form-loading"),s.section?(new IntersectionObserver(e=>{e.forEach(e=>{o.isVisible=e.isIntersecting,s.wrapper&&(o.isVisible?s.wrapper.classList.add("visible"):s.wrapper.classList.remove("visible"))})},{threshold:.1,rootMargin:"-50px 0px -50px 0px"}).observe(s.section),function(){const e=e=>{if(!o.isHovering&&s.form&&s.section){const t=s.section,n=s.form,r=(t.getBoundingClientRect(),n.getBoundingClientRect()),i=r.left+r.width/2,c=r.top+r.height/2,l=e.clientX-i,m=e.clientY-c,d=m/r.height*-10,u=l/r.width*10,p=l/r.width*10,f=m/r.height*10;o.mousePosition={x:p,y:f,rotateX:Math.max(-10,Math.min(10,d)),rotateY:Math.max(-10,Math.min(10,u))},a()}};s.section&&s.section.addEventListener("mousemove",e);s.form&&(s.form.addEventListener("mouseenter",()=>{o.isHovering=!0,a()}),s.form.addEventListener("mouseleave",()=>{o.isHovering=!1,a()}))}(),function(){if(!s.form)return;d(1);const e=document.getElementById("btn-next-1");e&&e.addEventListener("click",e=>{e.preventDefault(),u()});const t=document.getElementById("btn-previous-2"),n=document.getElementById("btn-next-2");t&&t.addEventListener("click",e=>{e.preventDefault(),p()});n&&n.addEventListener("click",e=>{e.preventDefault(),u()});const r=document.getElementById("btn-previous-3");r&&r.addEventListener("click",e=>{e.preventDefault(),p()});s.navigationButtons.submit&&s.navigationButtons.submit.addEventListener("click",v);Object.keys(s.formInputs).forEach(e=>{const t=s.formInputs[e];if(t)if("addon_services"===e||"consent_processing"===e){(Array.isArray(t)||t instanceof NodeList?t:[t]).forEach(e=>{e.addEventListener("change",m)})}else"primary_service"!==e&&t.addEventListener("input",m)})}(),function(){s.ctaServiceDropdownTrigger&&s.ctaServiceDropdownTrigger.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),o.isCtaServiceDropdownOpen?c():(o.isCtaServiceDropdownOpen=!0,s.ctaServiceDropdownMenu&&(s.ctaServiceDropdownMenu.style.display="block",s.ctaServiceDropdownMenu.offsetHeight),s.ctaServiceArrow&&s.ctaServiceArrow.classList.add("open"),s.ctaServiceDropdownTrigger&&s.ctaServiceDropdownTrigger.setAttribute("aria-expanded","true"))});s.ctaServiceOptions.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation();l(e.currentTarget.dataset.value),c()})})}(),document.addEventListener("click",e=>{s.ctaServiceDropdown&&!s.ctaServiceDropdown.contains(e.target)&&c()}),Object.keys(s.formInputs).forEach(e=>{const t=s.formInputs[e];t?(Array.isArray(t)||t instanceof NodeList?t:[t]).forEach(e=>{e.addEventListener("input",()=>{e.style&&(e.style.borderColor=""),e.closest(".consent-item")&&e.closest(".consent-item").classList.remove("error"),S()})}):"primary_service"===e&&s.ctaServiceOptions.forEach(e=>{e.addEventListener("click",()=>{s.ctaServiceDropdownTrigger&&(s.ctaServiceDropdownTrigger.style.borderColor=""),S()})})}),E(),I()):console.warn("CTA section not found")}function a(){if(!s.form)return;const e=function(){if(o.isHovering)return"perspective(1000px) rotateX(0deg) rotateY(0deg) translateX(0px) translateY(0px) scale(1)";const{x:e,y:t,rotateX:n,rotateY:r}=o.mousePosition;return`perspective(1000px) rotateX(${n||0}deg) rotateY(${r||0}deg) translateX(${e||0}px) translateY(${t||0}px) scale(1.02)`}(),t=o.isHovering?"transform 0.3s ease-out":"transform 0.1s ease-out";s.form.style.transform=e,s.form.style.transition=t}function c(){o.isCtaServiceDropdownOpen=!1,s.ctaServiceDropdownMenu&&(s.ctaServiceDropdownMenu.style.display="none"),s.ctaServiceArrow&&s.ctaServiceArrow.classList.remove("open"),s.ctaServiceDropdownTrigger&&s.ctaServiceDropdownTrigger.setAttribute("aria-expanded","false")}function l(e){if(e){if(o.formData.primary_service=e,s.ctaServiceLabel){const t=s.ctaServiceOptions.find(t=>t.dataset.value===e);t?s.ctaServiceLabel.textContent=t.querySelector(".option-name").textContent:""===e&&(s.ctaServiceLabel.textContent="Please Select")}s.formInputs.primary_service&&(s.formInputs.primary_service.value=e),s.ctaServiceOptions.forEach(t=>{t.dataset.value===e?t.classList.add("selected"):t.classList.remove("selected")})}}function m(){Object.keys(s.formInputs).forEach(e=>{const t=s.formInputs[e];if(t)if("addon_services"===e||"consent_processing"===e){const n=Array.isArray(t)||t instanceof NodeList?t:[t];"addon_services"===e?(o.formData.addon_services=[],n.forEach(e=>{e.checked&&o.formData.addon_services.push(e.value)})):o.formData[e]=n[0].checked}else"primary_service"===e||(o.formData[e]=t.value)})}function d(e){o.currentStep=e,s.steps.forEach((e,t)=>{e.classList.remove("active"),setTimeout(()=>{e.style.display="none"},300)}),setTimeout(()=>{s.steps[e-1]&&(s.steps[e-1].style.display="block",setTimeout(()=>{s.steps[e-1].classList.add("active")},50))},300),s.stepIndicators.forEach((e,t)=>{const n=t+1;e.classList.remove("active","completed"),n===o.currentStep?e.classList.add("active"):n<o.currentStep&&e.classList.add("completed")}),s.stepConnectors.forEach((e,t)=>{t+1<o.currentStep?e.classList.add("completed"):e.classList.remove("completed")}),function(){const e=document.getElementById("btn-previous-2"),t=document.getElementById("btn-previous-3"),n=document.getElementById("btn-next-1"),r=document.getElementById("btn-next-2"),s=document.getElementById("contact-submit");[e,t,n,r,s].forEach(e=>{e&&(e.style.display="none")}),1===o.currentStep?n&&(n.style.display="flex"):2===o.currentStep?(e&&(e.style.display="flex"),r&&(r.style.display="flex")):3===o.currentStep&&(t&&(t.style.display="flex"),s&&(s.style.display="flex"))}(),3===e&&function(){const e=document.getElementById("summary-content");if(!e)return;m();const{company:t,firstname:n,lastname:r,email:s,phone:i,primary_service:a,addon_services:c}=o.formData;let l=`\n            <div style="margin-bottom: 1rem;">\n                <strong>${n} ${r}</strong><br>\n                <span style="color: rgba(255,255,255,0.7);">${t}</span><br>\n                <span style="color: rgba(255,255,255,0.7);">${s}</span>\n                ${i?`<br><span style="color: rgba(255,255,255,0.7);">${i}</span>`:""}\n            </div>\n        `;a&&(l+=`\n                <div style="margin-bottom: 1rem;">\n                    <strong>Primary Service:</strong><br>\n                    <span style="color: rgba(255,255,255,0.7);">${a}</span>\n                </div>\n            `);c.length>0&&(l+=`\n                <div>\n                    <strong>Additional Services:</strong><br>\n                    <span style="color: rgba(255,255,255,0.7);">${c.join(", ")}</span>\n                </div>\n            `);e.innerHTML=l}(),Object.keys(s.formInputs).forEach(e=>{const t=s.formInputs[e];t&&("addon_services"===e?t.forEach(e=>{e.checked=o.formData.addon_services.includes(e.value)}):"consent_processing"===e?t.checked=o.formData[e]||!1:"primary_service"===e?l(o.formData[e]||""):t.value=o.formData[e]||"")})}function u(){f()&&o.currentStep<o.totalSteps&&d(o.currentStep+1)}function p(){o.currentStep>1&&d(o.currentStep-1)}function f(){switch(S(),o.currentStep){case 1:return function(){const e=[];["company","firstname","lastname","email"].forEach(t=>{const n=s.formInputs[t];n&&n.value.trim()?n&&(n.style.borderColor=""):(e.push(t),n&&(n.style.borderColor="#ff6b6b"))});const t=s.formInputs.email;if(t&&t.value.trim()){if(!/^[\w.-]+@[\w.-]+\.[a-zA-Z]{2,}$/.test(t.value.trim()))return t.style.borderColor="#ff6b6b",b("Please enter a valid email address."),!1}if(e.length>0)return b("Please fill in all required fields."),!1;return!0}();case 2:return function(){const e=s.formInputs.primary_service,t=s.ctaServiceDropdownTrigger;if(!e||!e.value.trim())return t&&(t.style.borderColor="#ff6b6b"),b("Please select a primary service."),!1;t&&(t.style.borderColor="");return!0}();case 3:return function(){const e=s.formInputs.consent_processing;if(!e||!e.checked)return e&&e.closest(".consent-item").classList.add("error"),b("You must consent to data processing to continue."),!1;e&&e.closest(".consent-item").classList.remove("error");return!0}();default:return!0}}async function v(i){if(i.preventDefault(),o.isSubmitting)return;if(m(),!f())return;const a=function(e){const t=[];e.company.trim()||t.push("Company name is required.");e.firstname.trim()||t.push("First name is required.");e.lastname.trim()||t.push("Last name is required.");e.email.trim()?(n=e.email,/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)||t.push("Please enter a valid email address.")):t.push("Email address is required.");var n;e.consent_processing||t.push("You must consent to data processing.");return{isValid:0===t.length,errors:t}}(o.formData);if(a.isValid){o.isSubmitting=!0,g(!0),S(),s.formLoading&&(s.formLoading.style.display="block");try{const i=await async function(n){try{const o={fields:[{name:"company",value:n.company},{name:"firstname",value:n.firstname},{name:"lastname",value:n.lastname},{name:"email",value:n.email},{name:"phone",value:n.phone||""},{name:"primary_service__select_one_",value:n.primary_service||""},{name:"addon_services",value:n.addon_services.join(", ")},{name:"consent_processing",value:n.consent_processing}],context:{pageUri:window.location.href,pageName:document.title,hutk:y("hubspotutk")}},s=`${r}/${e}/${t}`,i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(i.ok)return{success:!0};{const e=await i.text();throw console.error("HubSpot submission error:",e),new Error("Failed to submit to HubSpot")}}catch(e){throw console.error("HubSpot API Error:",e),e}}(o.formData);if(!i.success)throw new Error(i.message||"Submission failed");!function(e){if(S(),s.formSuccess){s.formSuccess.style.display="block";const t=s.formSuccess.querySelector("p");t&&(t.textContent=e)}}("Thank you! We'll be in touch within 24 hours."),setTimeout(()=>{window.open(n,"_blank")},2e3),setTimeout(()=>{h()},3e3)}catch(e){console.error("Form submission error:",e),b("Something went wrong. Please try again or contact us directly.")}o.isSubmitting=!1,g(!1),s.formLoading&&(s.formLoading.style.display="none")}else b(a.errors.join(" "))}function y(e){const t=`; ${document.cookie}`.split(`; ${e}=`);return 2===t.length?t.pop().split(";").shift():null}function g(e){if(!s.navigationButtons.submit)return;const t=s.navigationButtons.submit.querySelector(".cta-button-text");e?(s.navigationButtons.submit.disabled=!0,s.navigationButtons.submit.classList.add("submitting"),t&&(t.textContent="Submitting...")):(s.navigationButtons.submit.disabled=!1,s.navigationButtons.submit.classList.remove("submitting"),t&&(t.textContent="Request My Free Assessment"))}function b(e){if(S(),s.formError){s.formError.style.display="block";const t=s.formError.querySelector("p");t?t.textContent=e:s.formError.textContent=e}setTimeout(()=>{S()},8e3)}function S(){s.formSuccess&&(s.formSuccess.style.display="none"),s.formError&&(s.formError.style.display="none")}function h(){s.form&&s.form.reset(),Object.keys(o.formData).forEach(e=>{o.formData[e]="addon_services"===e?[]:"consent_processing"!==e&&""}),d(1),Object.keys(s.formInputs).forEach(e=>{const t=s.formInputs[e];if(t){(Array.isArray(t)||t instanceof NodeList?t:[t]).forEach(e=>{e.style&&(e.style.borderColor=""),e.closest(".consent-item")&&e.closest(".consent-item").classList.remove("error")})}}),S()}function w(){s.form&&(s.form.style.transform="perspective(1000px) rotateX(0deg) rotateY(0deg) translateX(0px) translateY(0px) scale(1)"),o.isHovering=!1,o.mousePosition={x:0,y:0,rotateX:0,rotateY:0}}function E(){window.matchMedia("(prefers-reduced-motion: reduce)").matches&&s.form&&(s.form.style.transform="none",s.form.style.transition="none")}function I(){window.innerWidth<=768&&s.form&&(s.form.style.transform="none !important",s.form.style.transition="all 0.3s ease !important")}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i(),window.addEventListener("resize",I);const L=window.matchMedia("(prefers-reduced-motion: reduce)");L.addListener?L.addListener(E):L.addEventListener("change",E),E(),I(),window.addEventListener("beforeunload",w),window.aetherbloomCTA={init:i,cleanup:w,nextStep:u,previousStep:p,showStep:d,resetForm:h,getCurrentStep:()=>o.currentStep,getFormData:()=>o.formData,validateCurrentStep:f,selectCtaService:l}}();